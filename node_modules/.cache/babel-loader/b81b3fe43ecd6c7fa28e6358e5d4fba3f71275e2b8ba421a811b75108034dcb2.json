{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{useNavigate}from\"react-router-dom\";import{BarChart,Bar,XAxis,YAxis,Tooltip,Legend,ResponsiveContainer}from\"recharts\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const SaalisTabs=()=>{const[activeTab,setActiveTab]=useState(\"historia\");const[saaliit,setSaaliit]=useState([]);const navigate=useNavigate();useEffect(()=>{const data=JSON.parse(localStorage.getItem(\"saalisdata\")||\"[]\");setSaaliit(data.reverse());},[]);const yhteenvetoData=saaliit.reduce((acc,_ref)=>{let{laji,maara,paino}=_ref;if(!acc[laji])acc[laji]={laji,maara:0,paino:0};acc[laji].maara+=Number(maara);acc[laji].paino+=Number(paino);return acc;},{});const yhteenveto=Object.values(yhteenvetoData);const lataaCSV=()=>{const otsikot=[\"Aika\",\"Paikka\",\"Laji\",\"M√§√§r√§\",\"Paino\",\"C&R\",\"Ilmanpaine\",\"Tuulensuunta\",\"Kuun asema\"];const rivit=saaliit.map(s=>[new Date(s.aika).toLocaleString(),s.paikka,s.laji,s.maara,s.paino,s.cr||0,s.ilmanpaine||\"\",s.tuulensuunta||\"\",s.kuu||\"\"]);const csv=[otsikot,...rivit].map(rivi=>rivi.map(kentta=>`\"${String(kentta).replace(/\"/g,'\"\"')}\"`).join(\",\")).join(\"\\n\");const blob=new Blob([csv],{type:\"text/csv;charset=utf-8;\"});const link=document.createElement(\"a\");link.href=URL.createObjectURL(blob);link.setAttribute(\"download\",\"saalisdata.csv\");document.body.appendChild(link);link.click();document.body.removeChild(link);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83C\\uDFA3 Saalistiedot\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"1em\",marginBottom:\"1em\"},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab(\"historia\"),children:\"\\uD83D\\uDCCB Historia\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab(\"yhteenveto\"),children:\"\\uD83D\\uDCCA Yhteenveto\"}),/*#__PURE__*/_jsx(\"button\",{onClick:lataaCSV,children:\"\\uD83D\\uDCC1 Lataa CSV\"})]}),activeTab===\"historia\"&&/*#__PURE__*/_jsx(\"div\",{children:saaliit.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Ei tallennettuja saaliita viel\\xE4.\"}):/*#__PURE__*/_jsx(\"ul\",{children:saaliit.map((s,i)=>/*#__PURE__*/_jsxs(\"li\",{style:{marginBottom:\"0.5em\"},children:[/*#__PURE__*/_jsx(\"strong\",{children:new Date(s.aika).toLocaleString()}),\" \\u2013 \",s.laji,\" (\",s.maara,\" kpl / \",s.paino,\" kg)\",s.cr?` (C&R: ${s.cr})`:\"\",\" @ \",s.paikka,s.ilmanpaine||s.tuulensuunta||s.kuu?/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:\"0.9em\",color:\"#555\"},children:[s.ilmanpaine&&`Ilmanpaine: ${s.ilmanpaine} hPa`,\" \",s.tuulensuunta&&`| Tuuli: ${s.tuulensuunta}`,\" \",s.kuu&&`| Kuu: ${s.kuu}`]}):null]},i))})}),activeTab===\"yhteenveto\"&&/*#__PURE__*/_jsx(\"div\",{children:yhteenveto.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"Ei riitt\\xE4v\\xE4sti dataa kaavion luomiseen.\"}):/*#__PURE__*/_jsx(ResponsiveContainer,{width:\"100%\",height:300,children:/*#__PURE__*/_jsxs(BarChart,{data:yhteenveto,children:[/*#__PURE__*/_jsx(XAxis,{dataKey:\"laji\"}),/*#__PURE__*/_jsx(YAxis,{}),/*#__PURE__*/_jsx(Tooltip,{}),/*#__PURE__*/_jsx(Legend,{}),/*#__PURE__*/_jsx(Bar,{dataKey:\"maara\",name:\"Kappalem\\xE4\\xE4r\\xE4\",fill:\"#82ca9d\"}),/*#__PURE__*/_jsx(Bar,{dataKey:\"paino\",name:\"Yhteispaino (kg)\",fill:\"#8884d8\"})]})})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>navigate(\"/\"),style:{marginTop:\"2em\",padding:\"0.5em\"},children:\"\\uD83D\\uDD19 Palaa ennusteeseen\"})]});};export default SaalisTabs;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","BarChart","Bar","XAxis","YAxis","Tooltip","Legend","ResponsiveContainer","jsx","_jsx","jsxs","_jsxs","SaalisTabs","activeTab","setActiveTab","saaliit","setSaaliit","navigate","data","JSON","parse","localStorage","getItem","reverse","yhteenvetoData","reduce","acc","_ref","laji","maara","paino","Number","yhteenveto","Object","values","lataaCSV","otsikot","rivit","map","s","Date","aika","toLocaleString","paikka","cr","ilmanpaine","tuulensuunta","kuu","csv","rivi","kentta","String","replace","join","blob","Blob","type","link","document","createElement","href","URL","createObjectURL","setAttribute","body","appendChild","click","removeChild","children","style","display","gap","marginBottom","onClick","length","i","fontSize","color","width","height","dataKey","name","fill","marginTop","padding"],"sources":["C:/Users/veli-pelli/Documents/KalastusApp/frontend/src/components/SaalisTabs.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport {\r\n  BarChart,\r\n  Bar,\r\n  XAxis,\r\n  YAxis,\r\n  Tooltip,\r\n  Legend,\r\n  ResponsiveContainer,\r\n} from \"recharts\";\r\n\r\nconst SaalisTabs = () => {\r\n  const [activeTab, setActiveTab] = useState(\"historia\");\r\n  const [saaliit, setSaaliit] = useState([]);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const data = JSON.parse(localStorage.getItem(\"saalisdata\") || \"[]\");\r\n    setSaaliit(data.reverse());\r\n  }, []);\r\n\r\n  const yhteenvetoData = saaliit.reduce((acc, { laji, maara, paino }) => {\r\n    if (!acc[laji]) acc[laji] = { laji, maara: 0, paino: 0 };\r\n    acc[laji].maara += Number(maara);\r\n    acc[laji].paino += Number(paino);\r\n    return acc;\r\n  }, {});\r\n\r\n  const yhteenveto = Object.values(yhteenvetoData);\r\n\r\n  const lataaCSV = () => {\r\n    const otsikot = [\"Aika\", \"Paikka\", \"Laji\", \"M√§√§r√§\", \"Paino\", \"C&R\", \"Ilmanpaine\", \"Tuulensuunta\", \"Kuun asema\"];\r\n    const rivit = saaliit.map(s => [\r\n      new Date(s.aika).toLocaleString(),\r\n      s.paikka,\r\n      s.laji,\r\n      s.maara,\r\n      s.paino,\r\n      s.cr || 0,\r\n      s.ilmanpaine || \"\",\r\n      s.tuulensuunta || \"\",\r\n      s.kuu || \"\"\r\n    ]);\r\n    const csv = [otsikot, ...rivit]\r\n      .map(rivi => rivi.map(kentta => `\"${String(kentta).replace(/\"/g, '\"\"')}\"`).join(\",\"))\r\n      .join(\"\\n\");\r\n\r\n    const blob = new Blob([csv], { type: \"text/csv;charset=utf-8;\" });\r\n    const link = document.createElement(\"a\");\r\n    link.href = URL.createObjectURL(blob);\r\n    link.setAttribute(\"download\", \"saalisdata.csv\");\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <h2>üé£ Saalistiedot</h2>\r\n      <div style={{ display: \"flex\", gap: \"1em\", marginBottom: \"1em\" }}>\r\n        <button onClick={() => setActiveTab(\"historia\")}>üìã Historia</button>\r\n        <button onClick={() => setActiveTab(\"yhteenveto\")}>üìä Yhteenveto</button>\r\n        <button onClick={lataaCSV}>üìÅ Lataa CSV</button>\r\n      </div>\r\n\r\n      {activeTab === \"historia\" && (\r\n        <div>\r\n          {saaliit.length === 0 ? (\r\n            <p>Ei tallennettuja saaliita viel√§.</p>\r\n          ) : (\r\n            <ul>\r\n              {saaliit.map((s, i) => (\r\n                <li key={i} style={{ marginBottom: \"0.5em\" }}>\r\n                  <strong>{new Date(s.aika).toLocaleString()}</strong> ‚Äì {s.laji} ({s.maara} kpl / {s.paino} kg)\r\n                  {s.cr ? ` (C&R: ${s.cr})` : \"\"} @ {s.paikka}\r\n                  {s.ilmanpaine || s.tuulensuunta || s.kuu ? (\r\n                    <div style={{ fontSize: \"0.9em\", color: \"#555\" }}>\r\n                      {s.ilmanpaine && `Ilmanpaine: ${s.ilmanpaine} hPa`} {s.tuulensuunta && `| Tuuli: ${s.tuulensuunta}`} {s.kuu && `| Kuu: ${s.kuu}`}\r\n                    </div>\r\n                  ) : null}\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {activeTab === \"yhteenveto\" && (\r\n        <div>\r\n          {yhteenveto.length === 0 ? (\r\n            <p>Ei riitt√§v√§sti dataa kaavion luomiseen.</p>\r\n          ) : (\r\n            <ResponsiveContainer width=\"100%\" height={300}>\r\n              <BarChart data={yhteenveto}>\r\n                <XAxis dataKey=\"laji\" />\r\n                <YAxis />\r\n                <Tooltip />\r\n                <Legend />\r\n                <Bar dataKey=\"maara\" name=\"Kappalem√§√§r√§\" fill=\"#82ca9d\" />\r\n                <Bar dataKey=\"paino\" name=\"Yhteispaino (kg)\" fill=\"#8884d8\" />\r\n              </BarChart>\r\n            </ResponsiveContainer>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      <button onClick={() => navigate(\"/\")} style={{ marginTop: \"2em\", padding: \"0.5em\" }}>\r\n        üîô Palaa ennusteeseen\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SaalisTabs;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}